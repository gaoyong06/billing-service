# Billing Service 产品需求文档 (PRD)

**服务名称**：Billing Service
**文档版本**：v1.0
**创建日期**：2024-12-01
**产品理念**：透明、准确、可靠

> "少即是多" - 张小龙

## 1. 产品定位

### 1.1 一句话定位
**DevShare 平台的财务中心，负责管理开发者的钱包、配额与账单。**

### 1.2 核心价值主张
- **透明**：每一笔消费都可追溯。
- **灵活**：支持"免费额度 + 余额扣费"的混合支付模式。
- **可靠**：保证资金安全与数据一致性。

### 1.3 边界声明
- **只做**：余额管理、配额管理、扣费逻辑、充值流程。
- **不做**：身份认证（由 API Key Service 负责）。
- **不做**：支付通道对接（由 Payment Service 负责）。

## 2. 目标用户
- **独立开发者**：关注成本，需要查看余额和账单。
- **内部服务（Gateway）**：需要实时检查用户是否有权调用（配额检查）。

## 3. 功能范围 (MVP)

### 3.1 资产管理
- **免费额度**：
    - Passport: 10,000 次/月
    - Payment: 1,000 次/月
    - Asset: 1,000 次/月
    - 规则：每月 1 日 00:00 自动重置。
- **余额钱包**：
    - 支持充值（调用 Payment Service）。
    - 支持按量扣费。

### 3.2 计费核心 (Internal)
- **配额检查与扣减 (Check & Deduct)**：
    - 逻辑：优先扣除免费额度，不足时扣除余额。
    - 失败处理：余额不足时拦截请求。
    - 性能：需支持高并发检查。

### 3.3 账单与统计
- **消费流水**：记录每一笔 API 调用的扣费情况（时间、服务、金额/额度）。
- **调用统计**：今日/本月调用量概览。

## 4. 成功指标
- **扣费准确性**：100%
- **配额检查延迟**：P99 < 10ms
